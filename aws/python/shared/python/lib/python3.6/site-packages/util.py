DEBUG="DEBUG"
INFO="INFO"
ERROR="ERROR"

import boto3


def getConnectionId(event):
    try:
        connectionId = event['requestContext']['connectionId']
    except:
        connectionId = None

    return connectionId

def log(message, level=INFO, event=None, context=None):
    print(f"{level}: {message} [connectionId: {getConnectionId(event)}]")

def getDDBTable(name):
    ddb = boto3.resource('dynamodb')
    table = ddb.Table(name)
    return table